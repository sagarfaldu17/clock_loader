on:
  pull_request:
    branches:
      - main
      - master
  push:
    branches:
      - main
      - master
      - develop
name: "Build & Release"
jobs:
  build:
    name: Build & Release
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v1
      - uses: actions/setup-java@v1
        with:
          java-version: '12.x'
      - uses: subosito/flutter-action@v1
        with:
          flutter-version: '2.10.2'
      - run: flutter pub get
      - uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: "13.1"

      - name: Install Apple Certificate
        uses: apple-actions/import-codesign-certs@v1
        with:
          p12-file-base64: ${{ secrets.P12_BASE64 }}
          p12-password: ${{ secrets.P12_PASSWORD }}

      - name: Install the provisioning profile
        env:
          PROVISIONING_CERTIFICATE_BASE64: ${{ secrets.MOBILEPROVISION_BASE64 }}
        run: |
          PP_PATH=$RUNNER_TEMP/build_pp.mobileprovision
          echo -n "$PROVISIONING_CERTIFICATE_BASE64" | base64 --decode --output $PP_PATH
          mkdir -p ~/Library/MobileDevice/Provisioning\ Profiles
          cp $PP_PATH ~/Library/MobileDevice/Provisioning\ Profiles
          # - name: Building iOS release
          #   run: |
          #     flutter build ios --release --no-codesign


          # cd build/ios/iphoneos
          # mkdir Payload
          # cd Payload
          # ln -s ../Runner.app
          # cd ..
       # zip -r app.ipa Payload


     # - name: collect ipa artifacts
     #   uses: actions/upload-artifact@v2
     #   with:
     #     name: release
     #     # Path to the release files
     #     path: ../Runner.app

      - name: Cache IOS build
        uses: actions/cache@v3
        with:
          path: |
            ios
          key: build-release

      - name: Build resolve Swift dependencies
        run: xcodebuild -resolvePackageDependencies -workspace ios/Runner.xcworkspace -scheme Runner -configuration Release

      - name: Build xArchive
        run: |
          xcodebuild -workspace ios/Runner.xcworkspace -scheme Runner -configuration Release DEVELOPMENT_TEAM=7224G6JACN CODE_SIGN_IDENTITY='iOS Distribution' -sdk 'iphoneos' -destination 'generic/platform=iOS' -archivePath build-output/app.xcarchive PROVISIONING_PROFILE= 'MIIuxwYJKoZIhvcNAQcCoIIuuDCCLrQCAQExCzAJBgUrDgMCGgUAMIIe1AYJKoZIhvcNAQcBoIIexQSCHsE8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEYtOCI/Pgo8IURPQ1RZUEUgcGxpc3QgUFVCTElDICItLy9BcHBsZS8vRFREIFBMSVNUIDEuMC8vRU4iICJodHRwOi8vd3d3LmFwcGxlLmNvbS9EVERzL1Byb3BlcnR5TGlzdC0xLjAuZHRkIj4KPHBsaXN0IHZlcnNpb249IjEuMCI+CjxkaWN0PgoJPGtleT5BcHBJRE5hbWU8L2tleT4KCTxzdHJpbmc+Rmx1dHRlciBEZW1vPC9zdHJpbmc+Cgk8a2V5PkFwcGxpY2F0aW9uSWRlbnRpZmllclByZWZpeDwva2V5PgoJPGFycmF5PgoJPHN0cmluZz43MjI0RzZKQUNOPC9zdHJpbmc+Cgk8L2FycmF5PgoJPGtleT5DcmVhdGlvbkRhdGU8L2tleT4KCTxkYXRlPjIwMjItMDUtMTdUMDU6Mzg6NDhaPC9kYXRlPgoJPGtleT5QbGF0Zm9ybTwva2V5PgoJPGFycmF5PgoJCTxzdHJpbmc+aU9TPC9zdHJpbmc+Cgk8L2FycmF5PgoJPGtleT5Jc1hjb2RlTWFuYWdlZDwva2V5PgoJPGZhbHNlLz4KCTxrZXk+RGV2ZWxvcGVyQ2VydGlmaWNhdGVzPC9rZXk+Cgk8YXJyYXk+CgkJPGRhdGE+TUlJRnh6Q0NCSytnQXdJQkFnSVFHM1BJMEhXTkhLUzU3Zm5tWHR6eGxqQU5CZ2txaGtpRzl3MEJBUXNGQURCMU1VUXdRZ1lEVlFRREREdEJjSEJzWlNCWGIzSnNaSGRwWkdVZ1JHVjJaV3h2Y0dWeUlGSmxiR0YwYVc5dWN5QkRaWEowYVdacFkyRjBhVzl1SUVGMWRHaHZjbWwwZVRFTE1Ba0dBMVVFQ3d3Q1J6TXhFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1CNFhEVEl5TURVeE56QTFNalF4TkZvWERUSXpNRFV4TnpBMU1qUXhNMW93Z1kweEdqQVlCZ29Ka2lhSmsvSXNaQUVCREFvM01qSTBSelpLUVVOT01UWXdOQVlEVlFRRERDMUJjSEJzWlNCRWFYTjBjbWxpZFhScGIyNDZJRTFsYUhWc0lGSmhhbkIxZENBb056SXlORWMyU2tGRFRpa3hFekFSQmdOVkJBc01DamN5TWpSSE5rcEJRMDR4RlRBVEJnTlZCQW9NREUxbGFIVnNJRkpoYW5CMWRERUxNQWtHQTFVRUJoTUNWVk13Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRREVyK3N4SFR0WENwbXZkZ25BZVI1SXAwMmozQjQ3NzQvd2dza2ppTEhYelJobkdZeWVjMmxXS1M3cTlYRlprK3lSV011cjNPMkQwZW9HaWNBMjdaWjBQc0VaUFY2TDFuZ3J0cjBOTnZiYlhlQUpsTXEyRGdmdnpGVi8vbXJzcjZwbWhKSDVrWWZuOTFmWjIwVk9OM1BoNXdqQ3MyZVdaZWNGZE9uTmIwV0RLSHd4cDU3M3lrdWJPSWY2TTY1OEdSRVlHcENxSkFiN0xDWFBheEsxVzR1OHVkdE1PRUhBNmx3R0l2ckVteEtLVkdnVUZKSUlRSTk2MWtYMkl3Y1lYTjh0NngrYTYxVkpUeWRFbVRqNHUxR0ZvdEgxTnJ5UnFpQmU2NHJIUFBOZ0V3dXVhSDNxU0pjSXNSVUZTdlRLekh3ZExOeWZWYlVWaDYwWEtEZFg5Szh4QWdNQkFBR2pnZ0k0TUlJQ05EQU1CZ05WSFJNQkFmOEVBakFBTUI4R0ExVWRJd1FZTUJhQUZBbit3QldRK2E5a0NwSVN1U1lvWXd5WDdLZXlNSEFHQ0NzR0FRVUZCd0VCQkdRd1lqQXRCZ2dyQmdFRkJRY3dBb1loYUhSMGNEb3ZMMk5sY25SekxtRndjR3hsTG1OdmJTOTNkMlJ5WnpNdVpHVnlNREVHQ0NzR0FRVUZCekFCaGlWb2RIUndPaTh2YjJOemNDNWhjSEJzWlM1amIyMHZiMk56Y0RBekxYZDNaSEpuTXpBMU1JSUJIZ1lEVlIwZ0JJSUJGVENDQVJFd2dnRU5CZ2txaGtpRzkyTmtCUUV3Z2Y4d2djTUdDQ3NHQVFVRkJ3SUNNSUcyRElHelVtVnNhV0Z1WTJVZ2IyNGdkR2hwY3lCalpYSjBhV1pwWTJGMFpTQmllU0JoYm5rZ2NHRnlkSGtnWVhOemRXMWxjeUJoWTJObGNIUmhibU5sSUc5bUlIUm9aU0IwYUdWdUlHRndjR3hwWTJGaWJHVWdjM1JoYm1SaGNtUWdkR1Z5YlhNZ1lXNWtJR052Ym1ScGRHbHZibk1nYjJZZ2RYTmxMQ0JqWlhKMGFXWnBZMkYwWlNCd2IyeHBZM2tnWVc1a0lHTmxjblJwWm1sallYUnBiMjRnY0hKaFkzUnBZMlVnYzNSaGRHVnRaVzUwY3k0d053WUlLd1lCQlFVSEFnRVdLMmgwZEhCek9pOHZkM2QzTG1Gd2NHeGxMbU52YlM5alpYSjBhV1pwWTJGMFpXRjFkR2h2Y21sMGVTOHdGZ1lEVlIwbEFRSC9CQXd3Q2dZSUt3WUJCUVVIQXdNd0hRWURWUjBPQkJZRUZNUlVvSTlEbmlmL1lqakpzNzZvbkdCMDdpcFNNQTRHQTFVZER3RUIvd1FFQXdJSGdEQVRCZ29xaGtpRzkyTmtCZ0VIQVFIL0JBSUZBREFUQmdvcWhraUc5Mk5rQmdFRUFRSC9CQUlGQURBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQVFFQXB2TFNzdnZNMUFIRSs0TG5FUEc0SElRQ2cxM29tZFZ4Y0tOaFFsYkJhU2N2SGlxZCtkUXVsOTNVSTJFTzJvQVhJYUVvemxWV05GTFNpc2dNejdSeHpMVVBnSUJzT0RRZTVsbkxCbExtTk5sZlhEWDMzYXRBY2duSVhxaVJJTk5LOGhpcU9YcGNxc2xtVEtiM0RMaEJxL0oyTkdEc2ZVdXRnN2k2WVNHWHJYYW1lZjR2R2tZcm8vVFBleUxSbkh0a3l1Vkhnb3JBNGlEN24xZFV4UWxTb2ZTbkdoVkh2VjBaeFBKU2dCU2ZYL0hZR0dvNDlnTmx6aFdzTEZydVVGK2NKR1czMjlCV0d4bVozQ0o0N3VZV1lsdUNTRi9UL3Q0RGN1MUluOHFIajJ2TWFScnlpd1hEaDlSWFlwd2xSKzRZcjZPOWVXeEVTVTlwOVFIMFpKZzhYdz09PC9kYXRhPgoJPC9hcnJheT4KCgk8a2V5PkRFUi1FbmNvZGVkLVByb2ZpbGU8L2tleT4KCTxkYXRhPk1JSU0rZ1lKS29aSWh2Y05BUWNDb0lJTTZ6Q0NET2NDQVFFeER6QU5CZ2xnaGtnQlpRTUVBZ0VGQURDQ0FyTUdDU3FHU0liM0RRRUhBYUNDQXFRRWdnS2dNWUlDbkRBTURBZFdaWEp6YVc5dUFnRUJNQkFNQ2xScGJXVlViMHhwZG1VQ0FnRnNNQkVNQ0ZCc1lYUm1iM0p0TUFVTUEybFBVekFUREE1SmMxaGpiMlJsVFdGdVlXZGxaQUVCQURBWERBUk9ZVzFsREE5TlNTQkdiSFYwZEdWeUlFUmxiVzh3R0F3SVZHVmhiVTVoYldVTURFMWxhSFZzSUZKaGFuQjFkREFaREFsQmNIQkpSRTVoYldVTURFWnNkWFIwWlhJZ1JHVnRiekFkREF4RGNtVmhkR2x2YmtSaGRHVVhEVEl5TURVeE56QTFNemcwT0Zvd0hnd09WR1ZoYlVsa1pXNTBhV1pwWlhJd0RBd0tOekl5TkVjMlNrRkRUakFmREE1RmVIQnBjbUYwYVc5dVJHRjBaUmNOTWpNd05URTNNRFV5TkRFeldqQWdEQmRRY205bWFXeGxSR2x6ZEhKcFluVjBhVzl1Vkhsd1pRd0ZVMVJQVWtVd0t3d2JRWEJ3YkdsallYUnBiMjVKWkdWdWRHbG1hV1Z5VUhKbFptbDRNQXdNQ2pjeU1qUkhOa3BCUTA0d0xBd0VWVlZKUkF3a09EaGhOekk1WXpJdE5HTXpZUzAwTjJReUxUZzNaalF0TnpSbFkyVXhaRFV3WVdObE1Ec01GVVJsZG1Wc2IzQmxja05sY25ScFptbGpZWFJsY3pBaUJDRFdyTGFUQjdvV0NyMFhpSGdBekwxWmcrRmhhQXBoSlZCeDJUMzlwY1g0dFRDQjZRd01SVzUwYVhSc1pXMWxiblJ6Y0lIWUFnRUJzSUhTTURNTUZtRndjR3hwWTJGMGFXOXVMV2xrWlc1MGFXWnBaWElNR1RjeU1qUkhOa3BCUTA0dVkyOXRMbTFwTG1ac2RYUjBaWEl3R0F3VFltVjBZUzF5WlhCdmNuUnpMV0ZqZEdsMlpRRUIvekF4RENOamIyMHVZWEJ3YkdVdVpHVjJaV3h2Y0dWeUxuUmxZVzB0YVdSbGJuUnBabWxsY2d3S056SXlORWMyU2tGRFRqQVREQTVuWlhRdGRHRnpheTFoYkd4dmR3RUJBREE1REJaclpYbGphR0ZwYmkxaFkyTmxjM010WjNKdmRYQnpNQjhNRERjeU1qUkhOa3BCUTA0dUtnd1BZMjl0TG1Gd2NHeGxMblJ2YTJWdW9JSUlQRENDQWtNd2dnSEpvQU1DQVFJQ0NDM0YvSWpTeFV1Vk1Bb0dDQ3FHU000OUJBTURNR2N4R3pBWkJnTlZCQU1NRWtGd2NHeGxJRkp2YjNRZ1EwRWdMU0JITXpFbU1DUUdBMVVFQ3d3ZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1CNFhEVEUwTURRek1ERTRNVGt3TmxvWERUTTVNRFF6TURFNE1Ua3dObG93WnpFYk1Ca0dBMVVFQXd3U1FYQndiR1VnVW05dmRDQkRRU0F0SUVjek1TWXdKQVlEVlFRTERCMUJjSEJzWlNCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEVUTUJFR0ExVUVDZ3dLUVhCd2JHVWdTVzVqTGpFTE1Ba0dBMVVFQmhNQ1ZWTXdkakFRQmdjcWhrak9QUUlCQmdVcmdRUUFJZ05pQUFTWTZTODlRSEtrN1pNaWNvRVRITjBRbGZIRm8wNXgzQlFXMlE3bHBnVXFkMlI3WDA0NDA3c2NSTFYvOVIrMk1tSmR5ZW1FVzA4d1R4RmFBUDFZV0F5bDlROHNUUWRIRTNYYWw1ZVhiekZjN1N1ZGV5QTcyTGxVMlY2WnBEcFJDakdqUWpCQU1CMEdBMVVkRGdRV0JCUzdzTjZoV0RPSW1xU0ttZDYrdmV1djJzc2txekFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQTRHQTFVZER3RUIvd1FFQXdJQkJqQUtCZ2dxaGtqT1BRUURBd05vQURCbEFqRUFnK25CeEJaZUdsMDBHTm50Ny9Sc0RnQkdTN2pmc2tZUnhRLzk1bnFNb2FacnpzSUQxSnoxazhaMHVHcmZxaU1WQWpCdFpvb1F5dFFOMUUvTmpVTSt0SXBqcFROdTQyM2FGN2RrSDhoVEp2bUlZblE1Q3hkYnkxR29ET2dZQStlaXNpZ3dnZ0xtTUlJQ2JhQURBZ0VDQWdnekRlNzR2MHhvTGpBS0JnZ3Foa2pPUFFRREF6Qm5NUnN3R1FZRFZRUUREQkpCY0hCc1pTQlNiMjkwSUVOQklDMGdSek14SmpBa0JnTlZCQXNNSFVGd2NHeGxJRU5sY25ScFptbGpZWFJwYjI0Z1FYVjBhRzl5YVhSNU1STXdFUVlEVlFRS0RBcEJjSEJzWlNCSmJtTXVNUXN3Q1FZRFZRUUdFd0pWVXpBZUZ3MHhOekF5TWpJeU1qSXpNakphRncwek1qQXlNVGd3TURBd01EQmFNSEl4SmpBa0JnTlZCQU1NSFVGd2NHeGxJRk41YzNSbGJTQkpiblJsWjNKaGRHbHZiaUJEUVNBME1TWXdKQVlEVlFRTERCMUJjSEJzWlNCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEVUTUJFR0ExVUVDZ3dLUVhCd2JHVWdTVzVqTGpFTE1Ba0dBMVVFQmhNQ1ZWTXdXVEFUQmdjcWhrak9QUUlCQmdncWhrak9QUU1CQndOQ0FBUUdhNlJXYjMyZko5SE9ObzZTRzFiTlZEWmtTc21VYUpuNnlTQis0dlZZRDl6aWF1c1pSeTh1N3p1a0FiUUJFMFI4V2lhdG9Kd3BKWXJsNWdadlQzeGFvNEgzTUlIME1BOEdBMVVkRXdFQi93UUZNQU1CQWY4d0h3WURWUjBqQkJnd0ZvQVV1N0Rlb1ZnemlKcWtpcG5ldnIzcnI5ckxKS3N3UmdZSUt3WUJCUVVIQVFFRU9qQTRNRFlHQ0NzR0FRVUZCekFCaGlwb2RIUndPaTh2YjJOemNDNWhjSEJzWlM1amIyMHZiMk56Y0RBekxXRndjR3hsY205dmRHTmhaek13TndZRFZSMGZCREF3TGpBc29DcWdLSVltYUhSMGNEb3ZMMk55YkM1aGNIQnNaUzVqYjIwdllYQndiR1Z5YjI5MFkyRm5NeTVqY213d0hRWURWUjBPQkJZRUZIcEh1amlLRlNSSUlrYk52bzhhSkhzMEF5cHBNQTRHQTFVZER3RUIvd1FFQXdJQkJqQVFCZ29xaGtpRzkyTmtCZ0lSQkFJRkFEQUtCZ2dxaGtqT1BRUURBd05uQURCa0FqQVZES21PeHErV2FXdW5uOTFjMUFOWmJLNVMxR0RHaTNiZ3Q4V2k4UWw4NEpyamE3SGpmREhFSjNxbmpvbjlxM2NDTUdFeklQRXAvL21ITXE0cHlHUTlkbnRScE5JQ0wzYStZQ0tSOGRVNmRkeTA0c1lxbHY3R0NkeEtUOVVrOFB6S3NqQ0NBd2N3Z2dLdG9BTUNBUUlDQ0E5ZUNGeVRhOU5BTUFvR0NDcUdTTTQ5QkFNQ01ISXhKakFrQmdOVkJBTU1IVUZ3Y0d4bElGTjVjM1JsYlNCSmJuUmxaM0poZEdsdmJpQkRRU0EwTVNZd0pBWURWUVFMREIxQmNIQnNaU0JEWlhKMGFXWnBZMkYwYVc5dUlFRjFkR2h2Y21sMGVURVRNQkVHQTFVRUNnd0tRWEJ3YkdVZ1NXNWpMakVMTUFrR0ExVUVCaE1DVlZNd0hoY05NakV3TkRFME1qRXpNalV3V2hjTk1qVXdOVEV6TWpFeE5qSTFXakJPTVNvd0tBWURWUVFERENGWFYwUlNJRkJ5YjNacGMybHZibWx1WnlCUWNtOW1hV3hsSUZOcFoyNXBibWN4RXpBUkJnTlZCQW9NQ2tGd2NHeGxJRWx1WXk0eEN6QUpCZ05WQkFZVEFsVlRNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQUU0Tys3TVIwQUZScWpxSkdxbERCb3dzQzRPZ1VvaW0xUWZPdGxRb2hxWUxvVUdOQUJ2dHVtQjRVZG93WmRLdGFxTE9WRzNSUmhmZHRkb3NRSlJ5TXNHcU9DQVU4d2dnRkxNQXdHQTFVZEV3RUIvd1FDTUFBd0h3WURWUjBqQkJnd0ZvQVVla2U2T0lvVkpFZ2lSczIranhva2V6UURLbWt3UVFZSUt3WUJCUVVIQVFFRU5UQXpNREVHQ0NzR0FRVUZCekFCaGlWb2RIUndPaTh2YjJOemNDNWhjSEJzWlM1amIyMHZiMk56Y0RBekxXRnphV05oTkRBek1JR1dCZ05WSFNBRWdZNHdnWXN3Z1lnR0NTcUdTSWIzWTJRRkFUQjdNSGtHQ0NzR0FRVUZCd0lDTUcwTWExUm9hWE1nWTJWeWRHbG1hV05oZEdVZ2FYTWdkRzhnWW1VZ2RYTmxaQ0JsZUdOc2RYTnBkbVZzZVNCbWIzSWdablZ1WTNScGIyNXpJR2x1ZEdWeWJtRnNJSFJ2SUVGd2NHeGxJRkJ5YjJSMVkzUnpJR0Z1WkM5dmNpQkJjSEJzWlNCd2NtOWpaWE56WlhNdU1CMEdBMVVkRGdRV0JCVG5Ndzl0NjVkZjR4MittUHJmZEFadXB3NnluREFPQmdOVkhROEJBZjhFQkFNQ0I0QXdEd1lKS29aSWh2ZGpaQXdUQkFJRkFEQUtCZ2dxaGtqT1BRUURBZ05JQURCRkFpRUE4NDkvTzE3eUY4a0tCY1JOcGJDTjBvN2I0WUxEZEhZcjJsR3ozWWlkaGZFQ0lDVzE0SHRLUHBvc0d0NE9pbERkeTV5Y0xHOWlmUDI2T2h3bnA5bXo1NzJUTVlJQjJEQ0NBZFFDQVFFd2ZqQnlNU1l3SkFZRFZRUUREQjFCY0hCc1pTQlRlWE4wWlcwZ1NXNTBaV2R5WVhScGIyNGdRMEVnTkRFbU1DUUdBMVVFQ3d3ZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVEFnZ1BYZ2hjazJ2VFFEQU5CZ2xnaGtnQlpRTUVBZ0VGQUtDQjZUQVlCZ2txaGtpRzl3MEJDUU14Q3dZSktvWklodmNOQVFjQk1Cd0dDU3FHU0liM0RRRUpCVEVQRncweU1qQTFNVGN3TlRNNE5EaGFNQ29HQ1NxR1NJYjNEUUVKTkRFZE1Cc3dEUVlKWUlaSUFXVURCQUlCQlFDaENnWUlLb1pJemowRUF3SXdMd1lKS29aSWh2Y05BUWtFTVNJRUlHbE5JbFV4enByUCtrZ3VCMUJzb1NQVGE1R0dwWnl3RFR4a2U0aGwwSmlVTUZJR0NTcUdTSWIzRFFFSkR6RkZNRU13Q2dZSUtvWklodmNOQXdjd0RnWUlLb1pJaHZjTkF3SUNBZ0NBTUEwR0NDcUdTSWIzRFFNQ0FnRkFNQWNHQlNzT0F3SUhNQTBHQ0NxR1NJYjNEUU1DQWdFb01Bb0dDQ3FHU000OUJBTUNCRWd3UmdJaEFJN25tZ0JnT084OWlqYzBMUHUxaGwrOWRhTmpibUVUQk5qVkQ3aXhoRzJvQWlFQXRNZlBlakVLT3ZWZTRmOGhwYkgwOG10L1N6Q0lKdVpBVEZ0RDN3QS9SUUk9PC9kYXRhPgoJCQkJCQkJCQoJPGtleT5FbnRpdGxlbWVudHM8L2tleT4KCTxkaWN0PgoJCTxrZXk+YmV0YS1yZXBvcnRzLWFjdGl2ZTwva2V5PgoJCTx0cnVlLz4KCQkJCQoJCQkJPGtleT5hcHBsaWNhdGlvbi1pZGVudGlmaWVyPC9rZXk+CgkJPHN0cmluZz43MjI0RzZKQUNOLmNvbS5taS5mbHV0dGVyPC9zdHJpbmc+CgkJCQkKCQkJCTxrZXk+a2V5Y2hhaW4tYWNjZXNzLWdyb3Vwczwva2V5PgoJCTxhcnJheT4KCQkJCTxzdHJpbmc+NzIyNEc2SkFDTi4qPC9zdHJpbmc+CgkJCQk8c3RyaW5nPmNvbS5hcHBsZS50b2tlbjwvc3RyaW5nPgoJCTwvYXJyYXk+CgkJCQkKCQkJCTxrZXk+Z2V0LXRhc2stYWxsb3c8L2tleT4KCQk8ZmFsc2UvPgoJCQkJCgkJCQk8a2V5PmNvbS5hcHBsZS5kZXZlbG9wZXIudGVhbS1pZGVudGlmaWVyPC9rZXk+CgkJPHN0cmluZz43MjI0RzZKQUNOPC9zdHJpbmc+CgoJPC9kaWN0PgoJPGtleT5FeHBpcmF0aW9uRGF0ZTwva2V5PgoJPGRhdGU+MjAyMy0wNS0xN1QwNToyNDoxM1o8L2RhdGU+Cgk8a2V5Pk5hbWU8L2tleT4KCTxzdHJpbmc+TUkgRmx1dHRlciBEZW1vPC9zdHJpbmc+Cgk8a2V5PlRlYW1JZGVudGlmaWVyPC9rZXk+Cgk8YXJyYXk+CgkJPHN0cmluZz43MjI0RzZKQUNOPC9zdHJpbmc+Cgk8L2FycmF5PgoJPGtleT5UZWFtTmFtZTwva2V5PgoJPHN0cmluZz5NZWh1bCBSYWpwdXQ8L3N0cmluZz4KCTxrZXk+VGltZVRvTGl2ZTwva2V5PgoJPGludGVnZXI+MzY0PC9pbnRlZ2VyPgoJPGtleT5VVUlEPC9rZXk+Cgk8c3RyaW5nPjg4YTcyOWMyLTRjM2EtNDdkMi04N2Y0LTc0ZWNlMWQ1MGFjZTwvc3RyaW5nPgoJPGtleT5WZXJzaW9uPC9rZXk+Cgk8aW50ZWdlcj4xPC9pbnRlZ2VyPgo8L2RpY3Q+CjwvcGxpc3Q+oIINPzCCBDQwggMcoAMCAQICCGPnHCGdGpMnMA0GCSqGSIb3DQEBCwUAMHMxLTArBgNVBAMMJEFwcGxlIGlQaG9uZSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEgMB4GA1UECwwXQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxEzARBgNVBAoMCkFwcGxlIEluYy4xCzAJBgNVBAYTAlVTMB4XDTIy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' archive

      - name: Export ipa
        run: xcodebuild -exportArchive -archivePath build-output/app.xcarchive -exportPath build-output/ios -exportOptionsPlist ios/ExportOptions.plist

      - name: collect ipa artifacts
        uses: actions/upload-artifact@v2
        with:
          name: release-ipa
          # Path to the release files
          path: build-output/ios
      - name: 'Upload app to TestFlight'
        uses: apple-actions/upload-testflight-build@v1
        with:
          app-path: 'build-output/ios'
          issuer-id: ${{ secrets.APPSTORE_ISSUER_ID }}
          api-key-id: ${{ secrets.APPSTORE_API_KEY_ID }}
          api-private-key: ${{ secrets.APPSTORE_API_PRIVATE_KEY }}
      # - name: Cache Flutter dependencies
      #   uses: actions/cache@v1
      #   with:
      #     path: /Users/runner/hostedtoolcache/flutter
      #     key: ${{ runner.OS }}-flutter-install-cache-${{ env.flutter_version }}






# push to master, main, develop
# pull request on main master
